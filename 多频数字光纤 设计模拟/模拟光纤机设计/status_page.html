<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Helios </title>
	<link rel="stylesheet" href="assets/css/bootstrap.min.css?2019827" />
	<link rel="stylesheet" href="assets/css/global.css?2019827" />
	<!-- Font Awesome -->
	<link rel="stylesheet" href="assets/css/font-awesome.min.css?2019827" />
	<!-- Theme style -->
	<link rel="stylesheet" href="assets/css/AdminLTE.min.css?2019827" />
	<link rel="stylesheet" href="assets/css/skins/skin-black.min.css?2019827" />
	<link rel="stylesheet" href="assets/css/index.css?2019827">
</head>
<style>
	.viswCard span {
		color: #fff;
		margin-right: 0px;
	}

	.box-header .el-button--mini,
	.el-button--mini.is-round {
		padding: 1px 3px;
		color: #fff;
		vertical-align: middle;
	}

	.el-input {
		vertical-align: middle;
	}

	.label-text-vm {
		text-align: left;
	}

	.col-sm-4 {
		margin: 10px 0;
	}

	.row .label {
		display: inline-block;
		width: 18px;
		height: 18px;
		vertical-align: middle;
	}

	.list-group {
		margin-bottom: 0px;
	}

	.description-header .iconfont {
		font-size: 18px;
	}

	.nullempty {
		text-align: center;
		padding: 20px 0;
		font-family: 'Roboto Condensed';
	}

	.nullempty .icon {
		display: inline-block;
		margin-bottom: 5px;
		font-size: 60px;
	}
</style>

<body>

	<div class="wrapper" id="content" style="background:#f1f4f6; margin-top: 10px;">

		<div class="col-md-12" style="padding-left: 0px;">
			<div class="row">
				<!-- 设备信息 -->
				<div class="col-md-7">
					<div class="box box-primary">
						<div class="box-body box-profile" style="padding-top:22px ;">

							<div class="profile-user-img img-responsive img-circle">
								<span class="icon iconfont icon-caijishebeixinxichaxun"></span>
							</div>
							<p>&nbsp;</p>
							<ul class="list-group list-group-unbordered">

								<li class="list-group-item">
									<span class="icon iconfont icon-shebei"></span> Site No
									<a class="pull-right">222</a>
								</li>
								<li class="list-group-item">
									<span class="icon iconfont icon-shebei1"></span>Equipment ID
									<a class="pull-right">2222</a>
								</li>
								<!-- <li class="list-group-item" v-for="(v,i) in DEVICE" v-if="v.adr==51">
											<span class="icon iconfont icon-wendu1"></span>  {{v.name}} <a class="pull-right">{{v.value}}</a>
									</li> -->
							</ul>
						</div>
						<!-- /.box-body -->
					</div>
				</div>
				<!-- 设备信息 -->

				<!--  ROC start-->
				<div class="col-md-5">
					<div class="box">
						<table class="table table-hover">
							<tbody>
								<tr>
									<th width="200">Band</th>
									<th>UL O/P (DSP)</th>
									<th>DL I/P (DSP)</th>
								</tr>

								<tr v-for="(v,i) in 8">
									<td>{{i}}</td>
									<td>{{v}}</td>
									<td>{{v}}</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<!--  ROC end-->
			</div>
			<div class="row">
				<!--  Alarm start-->
				<div class="col-md-7">
					<!--  v-if="equipment=='au'" -->
					<div class="box">
						<div class="box-header with-border">
							<h3 class="box-title">
								<span class=" icon iconfont icon-shebeigaojing"></span> Alarm</h3>
						</div>

						<!-- 	<div class="row" v-if="alarmdata.length>0">
							<div class="col-sm-4" v-for="(v,i) in alarmdata">
								<div class="description-block border-right">
									<h5 class="description-header">
										{{v.name}}
										<span class="icon iconfont icon-gaojing3 text-green" v-if="v.value=='0'"></span>
										<span class="icon iconfont icon-gaojing3 text-red" v-if="v.value!='0'"></span>
									</h5>
								</div>
							</div>
						</div> -->
						<div class="row">
							<div class="col-sm-4">
								<div class="description-block border-right">
									<h5 class="description-header">
										Sync3 Sync Alarm
										<!---->
										<span class="icon iconfont icon-gaojing3 text-red"></span>
									</h5>
								</div>
							</div>
							<div class="col-sm-4">
								<div class="description-block border-right">
									<h5 class="description-header">
										Door Open
										<!---->
										<span class="icon iconfont icon-gaojing3 text-red"></span>
									</h5>
								</div>
							</div>
							<div class="col-sm-4">
								<div class="description-block border-right">
									<h5 class="description-header">
										Communication Failure
										<span class="icon iconfont icon-gaojing3 text-green"></span>
										<!---->
									</h5>
								</div>
							</div>
							<div class="col-sm-4">
								<div class="description-block border-right">
									<h5 class="description-header">
										Power Off 1
										<span class="icon iconfont icon-gaojing3 text-green"></span>
										<!---->
									</h5>
								</div>
							</div>
							<div class="col-sm-4">
								<div class="description-block border-right">
									<h5 class="description-header">
										Power Failure 1
										<span class="icon iconfont icon-gaojing3 text-green"></span>
										<!---->
									</h5>
								</div>
							</div>
							<div class="col-sm-4">
								<div class="description-block border-right">
									<h5 class="description-header">
										Sync1 Sync Alarm
										<!---->
										<span class="icon iconfont icon-gaojing3 text-red"></span>
									</h5>
								</div>
							</div>
							<div class="col-sm-4">
								<div class="description-block border-right">
									<h5 class="description-header">
										Sync2 Sync Alarm
										<span class="icon iconfont icon-gaojing3 text-green"></span>
										<!---->
									</h5>
								</div>
							</div>
							<div class="col-sm-4">
								<div class="description-block border-right">
									<h5 class="description-header">
										Over Temp
										<!---->
										<span class="icon iconfont icon-gaojing3 text-red"></span>
									</h5>
								</div>
							</div>
						</div>
						<div v-else class="nullempty">
							<span class="icon iconfont icon-kongshuju"></span>
							<h3>{{empty}}</h3>
						</div>
					</div>
				</div>
				<!--  Alarm end-->
				<!--  Light start-->
				<div class="col-md-5">
					<div class="box">

						<table class="table table-hover">
							<tbody>
								<tr>
									<th width="200">Optical</th>
									<th>Optical Receive Power</th>
									<th>Optical Transmit Power</th>
								</tr>
								<tr v-for="(v,i) in 8">
									<td> {{i+1}} </td>
									<td>{{v}}</td>
									<td>{{v}}</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<!--  Light end-->
			</div>
			<!-- Alarm end -->

		</div>

	</div>
	<script type="text/javascript" src="assets/js/jquery.js"></script>
	<script type="text/javascript" src="assets/js/vue.js"></script>
	<script type="text/javascript" src="assets/js/index.js"></script>
	<script type="text/javascript" src="assets/js/comment.js"></script>

	<style scoped>
	</style>
	<script type="text/javascript">
		var helios;
		let data = {
			equipment: sessionStorage.getItem("equipment"),
			empty: "EMPTY",
			rocData: {}, //ROC模块
			optical: {}, //光模块
			DEVICE: [], //设备信息
			alarmdata: [],
		};
		let getajax = {
			//ROT START
			getBand() {
				var obj1 = [6, 7];
				var obj = {
					"data": obj1.join(),
					"action": "READ"
				}
				util.getattrajax(obj, function (data) {
					var data = data.data;

					var length;
					var getdata = new Object;
					for (var i = 0; i < data.length; i++) {
						if (data[i].adr == obj1[i]) {
							getdata[obj1[i]] = data[i].value.split(",");
							length = data[i].value.split(",").length;
						}
					}
					getdata.length = length;
					helios.rocData = getdata;
				})

			},
			//optical start
			optical() {
				var obj1 = [70, 71, 72, 73]; //PIN
				obj1.push(74, 75, 76, 77); //pout
				var obj = {
					"data": obj1.join(),
					"action": "READ"
				}
				util.getattrajax(obj, function (data) {
					var data = data.data;

					var getdata = new Object;
					for (var i = 0; i < data.length; i++) {
						if (data[i].adr == obj1[i]) {
							getdata[obj1[i]] = data[i].value;
						}
					}
					getdata["s"] = [getdata[70], getdata[71], getdata[72], getdata[73]];
					getdata["f"] = [getdata[74], getdata[75], getdata[76], getdata[77]];
					getdata["length"] = getdata["f"].length;

					helios.optical = getdata;
				})
			},
		}
		helios = new Vue({
			el: "#content",
			data: data,
			mounted() {
				$("body").resize();

			},
			beforeMount() {
				/*console.log("创建前："); */
				/* this.Equipment();
				util.SetHeliosDevMsg();
				setTimeout(function () {
					getajax.getBand();
					getajax.optical();
					helios.getAlarm();
				}, 500); */

			},
			methods: { //温度，编号
				Equipment() {
					var obj1 = [51, 82, 83];
					var obj = {
						"data": obj1.join(),
						"action": "READ",
					}
					util.getattrajax(obj, function (data) {
						var data = (data.data);
						var data1 = [];
						for (var i = 0; i < data.length; i++) {
							if (51 == data[i].adr) {
								let obj = {
									adr: data[i].adr,
									name: "Temp",
									value: (data[i].value)
								}
								data1.push(obj);
							}
							if (82 == data[i].adr) {
								let obj = {
									adr: data[i].adr,
									name: "Site No",
									value: (data[i].value)
								}
								data1.push(obj);
							}
							if (83 == data[i].adr) {
								/* 	function int2hex(num, width) {
										var hex = "0123456789abcdef";
										var s = "";
										while (num) {
											s = hex.charAt(num % 16) + s;
											num = Math.floor(num / 16);
										}
										if (typeof width === "undefined" || width <= s.length) {
											return " " + s;
										}
										var delta = width - s.length;
										var padding = "";
										while (delta-- > 0) {
											padding += "0";
										}
										return " " + padding + s;
									} */
								let obj = {
									adr: data[i].adr,
									name: "Equipment ID",
									value: (data[i].value)
								}
								data1.push(obj);
							}
						}
						helios.DEVICE = data1
					});
				},


				getAlarm() {
					var adr = [266, 54, 55, 57, 56, 37, 38, 39, 40, 66, 67, 68, 69, 9, 10]; /* 58 59 60 61  DC AC 状态 */
					/* adr.push(37, 38, 39, 40); */
					/*41,42,43,44  OUTSYNC 
					adr.push(66, 67, 68, 69);  62, 63, 64, 65 光收发  
					adr.push(9, 10); 下行输入欠过 功率  */

					/* if (heliosUser[0] == $session || heliosUser[1] == $session || heliosUser[2] == $session) {
						adr.splice(9, 0, 66, 67, 68, 69);
					} */

					var obj = {
						"data": adr.join(),
						"action": "READ"
					};
					util.getattrajax(obj, function (data) {
						var data = data.data;

						var data1 = [];
						if (data.length > 0) {
							for (var i = 0; i < data.length; i++) {
								var obj = {
									adr: "",
									value: ""
								}

								if (266 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "Communication Failure", data[i].value, 281);
								}

								/* 	if (heliosUser[0] == $session || heliosUser[1] == $session || heliosUser[2] == $session) { */
								if (54 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "Power Off  1", data[i].value, 58);
								}
								if (55 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "Power Failure 1", data[i].value, 59);
								}
								if (56 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "Over Temp", data[i].value, 60);
								}
								if (57 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "Door Open", data[i].value, 61);
								}
								/* Sync1-Sync4 */
								if (37 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "Sync1 Sync Alarm", data[i].value, 41);
								}
								if (38 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "Sync2 Sync Alarm", data[i].value, 42);
								}
								if (39 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "Sync3 Sync Alarm", data[i].value, 43);
								}
								if (40 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "Sync4 Sync Alarm", data[i].value, 44);
								}
								/* } */

								/* LIGHTFAULT1- 4 */
								if (66 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "Optical Transceiver Failure 1", data[i].value, 62);
								}
								if (67 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "Optical Transceiver Failure 2", data[i].value, 63);
								}
								if (68 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "Optical Transceiver Failure 3", data[i].value, 64);
								}
								if (69 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "Optical Transceiver Failure 4", data[i].value, 65);
								}
								if (9 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "DL I/P Underpower", data[i].value, 11);
								}
								if (10 == data[i].adr) {
									helios.Alarm_state(data[i].adr, "DL I/P Overpower", data[i].value, 12);
								}

							}
						} else {
							toast.$message.error("Error");
						}
					})
				},

				//处理告警状态
				Alarm_state(Fadr, name, value, state) {
					if (Fadr != 9 && Fadr != 10) {
						let adr = [state];
						//console.log(adr);
						if (value == 3) { //全开=3 才进入处理
							var obj1 = {
								"data": adr.join(),
								"action": "READ",
							}
							util.getattrajax(obj1, function (data) {
								var data = (data.data);
								for (var i = 0; i < data.length; i++) {
									let obj = {
										adr: Fadr,
										name: name,
										value: data[i].value
									}
									helios.alarmdata.push(obj);
								}
							});
						}
					} else {
						//ROC 特殊处理
						if (Fadr == 9) {
							let adr = [state]; //状态地址码
							let Val = value.split(","); //获取6条ROC 使能
							var stateVal = [];
							var obj1 = {
								"data": adr.join(),
								"action": "READ",
							}
							util.getattrajax(obj1, function (data) {
								stateVal.push(data.data[0].value.split(","));
								//	stateVal[0][0] = "1"; //*这里设置一个开启告警，小苏没法调试；
								for (var i = 0; i < Val.length; i++) {
									if (Val[i] == "3") {
										let obj = {
											adr: Fadr,
											name: name + " " + i,
											value: stateVal[0][i]
										}
										helios.alarmdata.push(obj);
										//状态   --- 使能
										//console.log(stateVal[0][i] + "-" + i);
										//console.log(stateVal[i]);
										//console.log(i);
									}
								}
							});
						}
						if (Fadr == 10) {
							let adr = [state]; //状态地址码
							let Val = value.split(","); //获取6条ROC 使能
							var stateVal = [];
							var obj1 = {
								"data": adr.join(),
								"action": "READ",
							}
							util.getattrajax(obj1, function (data) {

								stateVal.push(data.data[0].value.split(","));
								//	stateVal[0][0] = "1"; //*这里设置一个开启告警，小苏没法调试；

								for (var i = 0; i < Val.length; i++) {
									if (Val[i] == "3") {
										let obj = {
											adr: Fadr,
											name: name + " " + i,
											value: stateVal[0][i]
										}
										helios.alarmdata.push(obj);
										//状态   --- 使能
										//console.log(stateVal[0][i] + "-" + i);
										//console.log(stateVal[i]);
										//console.log(i);
									}
								}
							});
						}
					}
				}


			},

		})
	</script>
</body>

</html>