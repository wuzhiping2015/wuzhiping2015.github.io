<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>ROC </title>
	<link rel="stylesheet" href="assets/css/bootstrap.min.css?2019827" />
	<link rel="stylesheet" href="assets/css/global.css?2019827" />
	<!-- Font Awesome -->
	<link rel="stylesheet" href="assets/css/font-awesome.min.css?2019827" />
	<!-- Theme style -->
	<link rel="stylesheet" href="assets/css/AdminLTE.min.css?2019827" />
	<link rel="stylesheet" href="assets/css/skins/skin-black.min.css?2019827" />
	<link rel="stylesheet" href="assets/css/index.css?2019827">
</head>

<style scoped>
	[class*="col-grid-s"]>li {
		width: 410px;
	}

	.nav-tabs-custom li {
		width: 120%;
	}

	.box .box-footer {
		border-top: 0px;
	}

	.label {
		font-size: 120%;
	}

	.el-dialog {
		width: 30%;
	}

	td span small {
		cursor: pointer;
	}

	.el-button--mini,
	.el-button--mini.is-round {
		padding: 1px 3px;
		color: #fff
	}

	.viswCard span {
		color: #fff;
		margin-right: 0px;
	}

	.viswCard {
		position: inherit;
		top: 4px;
		text-align: center;
	}

	.table-hover td {
		text-indent: 6px;
	}

	.table>tbody>tr.add>td,
	.table>tbody>tr>td.res {
		font-weight: bold;
		color: #333;
	}

	.table.res td .label {
		margin-left: 5px;
		float: right;
	}

	tr td:nth-child(4),
	tr.res td:nth-child(5) {
		background-color: rgb(218, 219, 219);
	}

	tr.res td:nth-child(4) {
		background-color: #fff;
	}

	div.col-xs-2 {
		padding: 0px !important;
		width: 25% !important;
	}

	div.col-xs-2.hover {
		width: 37.1% !important;
	}

	.dataTable td {
		height: 49px;
	}

	.col-xs-2 .el-checkbox-group:nth-child(1) {
		margin: 0 7px;
		float: left;
	}

	.el-checkbox-group:nth-child(2) {
		margin-right: 0px !important;
	}

	.el-checkbox__label {
		padding-left: 2px !important;
	}

	.el-checkbox__inner {
		vertical-align: 1px;
	}

	.col-xs-2.hover:hover {
		background: #f6fbfd;
	}

	.el-button {
		padding: 5px 32px !important;
	}
</style>

<body>
	<!-- hold-transition skin-blue-light sidebar-mini sidebar-collapse -->
	<div class="wrapper" id="content" style="background:#f1f4f6; margin-top:2px; margin-bottom: 30px;">
		<!--   Trap Destinations -->
		<div class="box">

			<div class="box-body" style="text-align: center; height: 95vh;" v-show="dataimg">
				<img src="assets/images/wifi.gif" style="margin-top: 10%;">
			</div>

			<div class="box-body table-responsive no-padding" v-show="databox">
				<div class="col-xs-2 ">


					<table class="table res table-bordered  dataTable first">
						<tbody>
							<tr>
								<td style="height:53px" colspan="2"> </td>
							</tr>
							<tr>
								<td colspan="2">
									<span class="icon iconfont icon-kongzhitai"></span>
									<b>Band</b>
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<b>DL PA I/P
									</b>
									<span class="text-green "> (dBm)</span>
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<b>DL PA O/P</b>
									<span class="text-green "> (dBm)</span>
								</td>
							</tr>

							<tr>
								<td colspan="2">
									<b>DL PA Temp</b>
									<span class="text-green "> (dBm)</span>
								</td>
							</tr>

							<tr>

								<td colspan="2">
									<b>DL PA Status</b>

									<span class="text-green ">(MHz)</span>
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<b>DL PA VSWR</b>
									<span class="text-green ">(MHz)</span>
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<b> UL LNA I/P</b>
									<span class="text-green ">(dB)</span>
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<b> UL LNA O/P</b>
									<span class="text-green ">(dB)</span>
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<b>Optical Tx Power</b>
									<span class="text-green ">(dB)</span>
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<b>Optical Rx Power</b>
									<span class="text-green ">(dB)</span>
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<b>DL PA ATT</b>
									<span class="text-green ">(dB)</span>
								</td>
							</tr>

							<tr>
								<td colspan="2">
									<b>DL PA Enable</b>
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<b>UL LNA ATT</b>
								</td>
							</tr>
							<tr>
								<td colspan="2">
									<b>Optical ATT</b>
								</td>
							</tr>

							<tr>
								<td rowspan="7">
									<b>Alarm Enable
									</b>
								</td>
								<td> DL PA Fault Alarm </td>
							</tr>
							<tr>
								<td> DL PA VSWR Alarm</td>
							</tr>
							<tr colspan="2">
								<td> DL PA Over Temp Alarm</td>
							</tr>
							<tr colspan="2">
								<td> DL PA Over Power Alarm</td>
							</tr>
							<tr colspan="2">
								<td> UL LNA Fault Alarm</td>
							</tr>

							<tr colspan="2">
								<td> Optical Rx Fault Alarm</td>
							</tr>
							<tr colspan="2">
								<td> Optical Tx Fault Alarm
							</tr>

							<tbody>
					</table>
				</div>



				<div class="col-xs-2 hover" v-for="(v,i) in Rocdata" :style="stylecss">
					<table class="table res table-bordered  dataTable">
						<tbody>
							<tr>
								<td style="height:45px">
									<div class="viswCard">
										<el-button size="medium" type="success" :disabled="!canSave" @click="Setroc_Data(i)">Set
										</el-button> &nbsp;&nbsp;
										<el-button type="primary" size="medium" :disabled="!Read" @click="Getroc_Data(i)">Read
										</el-button>
									</div>
								</td>
							</tr>
							<tr>
								<td v-html="$options.filters.bandname(i)"></td>
							</tr>
							<tr v-for="(vv,ii) in Rocdata[i]">
								<td v-if="vv.adr==99">{{vv.value}}</td>
								<td v-if="vv.adr==100">{{vv.value}}</td>
								<td v-if="vv.adr==101">{{vv.value}}</td>
								<td v-if="vv.adr==102">{{vv.value}}</td>
								<td v-if="vv.adr==103">{{vv.value}}</td>
								<td v-if="vv.adr==110">{{vv.value}}</td>
								<td v-if="vv.adr==111">{{vv.value}}</td>
								<td v-if="vv.adr==116">{{vv.value}}</td>
								<td v-if="vv.adr==117">{{vv.value}}</td>
								<td v-if="vv.adr==104">
									<el-select v-model="vv.value" size="mini">
										<el-option v-for="(vvv,iii) in 26" :label="iii" :value="iii"></el-option>
									</el-select>
								</td>
								<td v-if="vv.adr==105">
									<el-switch v-model="vv.value"></el-switch>
								</td>
								<td v-if="vv.adr==112">
									<el-select v-model="vv.value" size="mini">
										<el-option v-for="(vvv,iii) in 31" :label="iii" :value="iii"></el-option>
									</el-select>
								</td>
								<td v-if="vv.adr==118">
									<el-select v-model="vv.value" size="mini">
										<el-option v-for="(vvv,iii) in 31" :label="iii" :value="iii"></el-option>
									</el-select>
								</td>
								<td v-if="vv.adr==121 || vv.adr==122 || vv.adr==123 || vv.adr==124 || vv.adr==125 || vv.adr==126 || vv.adr==127">
									<el-checkbox-group size="small" v-model="vv.value[0]">
										<el-checkbox label="Agent" border></el-checkbox>
									</el-checkbox-group>

									<el-checkbox-group size="small" v-model="vv.value[1]">
										<el-checkbox label="Enable" border></el-checkbox>
									</el-checkbox-group>
								</td>

							</tr>
							<tr>
								<td style="height:45px">
									<div class="viswCard">
										<el-button size="medium" type="success" :disabled="!canSave" @click="Setroc_Data(i)">Set
										</el-button> &nbsp;&nbsp;
										<el-button type="primary" size="medium" :disabled="!Read" @click="Getroc_Data(i)">Read
										</el-button>
									</div>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>

	</div>
	</div>
	<!--   Trap Destinations-->
	<script type="text/javascript" src="assets/js/jquery.js"></script>
	<script type="text/javascript" src="assets/js/vue.js"></script>
	<script type="text/javascript" src="assets/js/index.js"></script>
	<script type="text/javascript" src="assets/js/comment.js"></script>
	<script>
		let data = {
			app: "",
			dataimg: true,
			databox: false,
			canSave: true,
			Read: true,
			Rocdata: [],
			Roclength: 1,
			heliosUser: heliosUser[0] == $session,
			heliosUser1: heliosUser[3] == $session,
		}
		var Helios = new Vue({
			el: "#content",
			data: data,
			mounted() {
				this.Getroc_Data();
				$("body").resize();
			},

			methods: {
				/* (9,10) 使能 范围 0-3 */
				Getroc_Data(tag) {
					//	util.SetHeliosDevMsg();
					let obj2 = new Array;
					let string = "";
					var Hi = 0;
					var getDATA = [];
					if (tag >= 0) {
						this.Read = false;
						string = `99,${tag},100,${tag} ,101,${tag} ,102,${tag} ,103,${tag} ,110,${tag},111,${tag},116,${tag},117,${tag},104,${tag},105,${tag},112,${tag},118,${tag},121,${tag},122,${tag},123,${tag},124,${tag},125,${tag},126,${tag},127,${tag}`

						var obj = {
							"data": string,
							"action": "READ_SINGLE"
						}
						$.ajax({
							url: "../cgi-bin/doaction.cgi",
							data: obj,
							type: "get",
							success: function (data, status) {
								var data = JSON.parse(data).data;
								data.forEach(function (value, index) {
									if (value.adr == 105) {
										if (value.value == "0") {
											(data[index]).value = false
										} else {
											(data[index]).value = true
										}
									}
									else if (value.adr == 121 || value.adr == 122 || value.adr == 123 || value.adr == 124 || value.adr == 125 || value.adr == 126 || value.adr == 127) {
										let resdata = Helios.ResTruefalseArray(data[index]);
										data[index].value = resdata;
									}
								});
								Helios.Rocdata.splice(tag, 1);
								Helios.Rocdata.splice(tag, 0, data);

								setTimeout(() => {
									util.success('success');
									Helios.Read = true;
								}, 200);
							},
							error: function (req, status, err) {
								console.log(req);
								console.log(status);
								console.log(err);
							}
						});
					}
					else {
						while (Hi <= this.Roclength) {
							string = `99,${Hi},100,${Hi} ,101,${Hi} ,102,${Hi} ,103,${Hi} ,110,${Hi},111,${Hi},116,${Hi},117,${Hi},104,${Hi},105,${Hi},112,${Hi},118,${Hi},121,${Hi},122,${Hi},123,${Hi},124,${Hi},125,${Hi},126,${Hi},127,${Hi}`

							var obj = {
								"data": string,
								"action": "READ_SINGLE"
							}
							$.ajax({
								url: "../cgi-bin/doaction.cgi",
								data: obj,
								type: "get",
								success: function (data, status) {
									var data = JSON.parse(data).data;
									data.forEach(function (value, index) {
										if (value.adr == 105) {
											if (value.value == "0") {
												(data[index]).value = false
											} else {
												(data[index]).value = true
											}
										}
										else if (value.adr == 121 || value.adr == 122 || value.adr == 123 || value.adr == 124 || value.adr == 125 || value.adr == 126 || value.adr == 127) {
											let resdata = Helios.ResTruefalseArray(data[index]);

											data[index].value = resdata;
										}
									});
									getDATA.push(data);
									Helios.Rocdata = getDATA;
									setTimeout(function () {
										Helios.dataimg = false;
										Helios.databox = true;
									}, 1500);
								},
								error: function (req, status, err) {
									console.log(req);
									console.log(status);
									console.log(err);
								}
							});
							Hi += 1;
						}
					}
				},

				Setroc_Data: function (tag) {
					Helios.$data.canSave = false;
					function resvalue(v) {
						let value;
						if (v == true) {
							value = 1 + ""
						} else if (v == false) {
							value = 0 + ""
						} else {
							value = v + "";
						}
						return value;
					}
					var setdata = [];
					let getRocdata = this.Rocdata;

					var t = 9;// 前面9条只读
					while (t < getRocdata[tag].length) {
						if (getRocdata[tag][t].adr == 104 || getRocdata[tag][t].adr == 105 || getRocdata[tag][t].adr == 112 || getRocdata[tag][t].adr == 118) {
							let obj1 = {};
							obj1 = {
								adr: Helios.Rocdata[tag][t].adr,
								value: resvalue(Helios.Rocdata[tag][t].value),
								index: tag + ""
							}
							setdata.push(obj1);
						} else {
							let obj1 = {};
							let resdata = Helios.resnumberAarray(Helios.Rocdata[tag][t]);
							obj1 = {
								adr: Helios.Rocdata[tag][t].adr,
								value: resdata,
								index: tag + ""
							}
							setdata.push(obj1);
						}
						t += 1;
					}
					var obj = {
						"data": JSON.stringify(setdata),
						"action": "SET_SINGLE"
					}
					util.postattrajax(obj, function (data) {
						if (1 != data) {
							Helios.$data.canSave = true;
							toast.$message({
								message: ' Error' + data,
								type: 'error',
								showClose: true,
								offset: 40
							});
						} else {
							setTimeout(() => {
								util.success('success');
								Helios.$data.canSave = true;
							}, 200);
						}
					});

				},
				ResTruefalseArray(resdata) {
					let Enable = [];
					if ("0" == resdata.value) {
						Enable.push(false, false);
					}
					if ("1" == resdata.value) {
						Enable.push(false, true);
					}
					if ("2" == resdata.value) {
						Enable.push(true, false);
					}
					if ("3" == resdata.value) {
						Enable.push(true, true);
					}
					return Enable;
				},
				resnumberAarray(resdata) {
					let make = "";
					if (resdata.value[0] == false && resdata.value[1] == false) {
						make = "0";
					} else if (resdata.value[0] == false && resdata.value[1] == true) {
						make = "1";
					} else if (resdata.value[0] == true && resdata.value[1] == false) {
						make = "2";
					} else if (resdata.value[0] == true && resdata.value[1] == true) {
						make = "3";
					}
					return make;
				}

			},
			filters: {
				bandname: function (value) {
					if (0 == value) {
						return "0st Band"
					} else if (1 == value) {
						return "1nd Band"
					}
					if (2 == value) {
						return "2rd Band"
					} else if (3 == value) {
						return "3th Band"
					} else if (4 == value) {
						return "4th Band"
					} else if (5 == value) {
						return "5th Band"
					}
				},
			},
			computed: {
				stylecss: function () {
					if (this.Roclength == 1) {
						return {
							width: "37.1% !important"
						}
					} else {
						return {
							width: "21.2% !important"
						}
					}
				},

			}
		});
	</script>

</body>

</html>